%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 0 - Projeto de filtro e sintese de voz%% %% a. projetar um filtro digital de fc = 1000Hz e aplicar ao sinal gaita.wav mesmo gr√°fico.%%%%  04 de junho de 2021%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 1 - Prepara√ß√£o do c√≥digo %% %% Boas pr√°ticas: limpeza de vari√°veis; vari√°veis globais%% Constantes; carregar bibliotecas;...%%%%% Limpezaclc;          % limpa visual da tela de comandosclose all;    % limpa as figurasclear all;    % limpa as vari√°veis%%% Pacote de controlepkg load control         %%% Polos e zeros pkg load signal          %%% --> Bilinear%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 2 - Sinal: calibra√ß√£o e sinal real%%%% trabalhar com um sinal amostrado%% %% trabalhar com um sinal real - gaita - ham√¥nica [gk,fs] = audioread ('gaita.wav');      % transformei um arquivo .wav em um vetor g(k)  fmax    = fs/2; Ng      = length(gk); T       = 1/fs;  tempo   = linspace(0,Ng*T,Ng); printf("A media movel consiste de um filtro 'passa baixa' que atenua frequencias mais altas e pouco altera frequencias baixas.\n"); printf("O ganho consiste da soma de N termos (iniciando em n=0)(1/N)*z^(-n)\n"); printf("\n"); printf("Digite um valor pra N (impar):\n"); N = input("N = ");  %%% N deve ser inserido no prompt %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 3 - An√°lise da resposta em frequ√™ncia da m√©dia m√≥vel%%                       N%% y(k)       = (1/N) * SUM g(k-n)%%                      n=0%%%%                      N%% Y(z)/G(z) = (1/N) * SUM z^(-n)%%                     n=0%% z = e^(jwT)%%% Amostragem - TT   = 1/fs;%%% vetor de frequ√™nciasNp  = Ng;w   = linspace(-pi*fs,pi*fs,Np);%%% Ganho em frequ√™ncia da m√©dia movel Para N genÈricoGanhoMM = 0;for k=0: N-1  GanhoMM  = GanhoMM + (1/N)*(exp(-1*k*j*w*T));endforModuloMM = abs(GanhoMM);FaseMM   = angle(GanhoMM);figure(1)subplot(2,1,1); plot(w/(2*pi),ModuloMM);xlabel('Frequencia em Hz') ylabel('Modulo')subplot(2,1,2); plot(w/(2*pi),FaseMM);xlabel('Frequencia em Hz') ylabel('Fase')%%% Conclus√µes% 1 trata-se de um filtro passa baixas% 2 tem N-1 nulos% 3 tem fase linear%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 4 - Aplicando o filtro ao sinal da gaita%%##     An equivalent form of the equation is:####                    N                   M##          y(n) = - SUM c(k+1) y(n-k) + SUM d(k+1) x(n-k)  for 1<=n<=length(x)##                   k=1                 k=0####     where c = a/a(1) and d = b/a(1).### Fun√ß√£o de transfer√™nciaNd    = (1/N)*ones(1, N);Dd    = [1 zeros(1, N-1)];GanhoFiltroMM = tf(Nd,Dd,T)yMM     = filter (Nd, Dd, gk);%%% Visualizando no tempofigure(2)subplot(2,1,1); plot(tempo,gk)xlabel('tempo em segundos')title('Entrada')subplot(2,1,2); plot(tempo,yMM)xlabel('tempo em segundos')title('Saida')%%% Visualizando na frequ√™nciaGkF = fft(gk);GkF = fftshift(GkF);figure(3)subplot(2,1,1); plot(w/(2*pi),ModuloMM);xlabel('Frequencia em Hz') ylabel('Modulo')axis ([-2000 +2000])subplot(2,1,2); plot(w/(2*pi),GkF);xlabel('Frequencia em Hz') ylabel('Modulo')axis ([-2000 +2000])%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 5 - Criando o sinal artificial%%%%  g1[k] = cos(w1*tempo) e w1 --> ao zero da FT%%%%% determinando os zeros do ganhozeros = roots(Nd);ModuloZeros = abs(zeros);FaseZeros   = angle(zeros);%%  2pi          - ws%%  ThetaZero1   - w1%%% frequ√™ncia angular do zero pela teoriaws   = 2*pi*fs;w1   = 0.8*FaseZeros(1)*ws/(2*pi);%% 14700Hzf1   = w1/(2*pi); %%% gerando o sinal gk1 - A * sin(wt + angulo)gk1 = 1 * sin(w1*tempo + 0);%%% Aplicando o filtroyMM1     = filter (Nd, Dd, gk1);%%% Visualizando no tempofigure(4)subplot(2,1,1); plot(tempo,gk1)xlabel('tempo em segundos')title('Entrada')axis ([0 1])subplot(2,1,2); plot(tempo,yMM1)xlabel('tempo em segundos')title('Saida')axis ([0 1])